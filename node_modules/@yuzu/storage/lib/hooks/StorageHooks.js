import { AppHooks } from "spak";
import { logger } from "spak/decorators";

@logger("storage")
@AppHooks.events("auth.sessionAuthenticated", "auth.sessionEnded")
export default class StorageHooks extends AppHooks {
    constructor(stores) {
        super();
        this._stores = stores;
    }

    onAppReady() {
        this._stores.initialize();
        this.logger.info("Data storage initialized.");
    }

    onAuthSessionAuthenticated() {
        this._stores.loadAll();
        this.logger.info("Data storage loaded.");
    }

    onAuthSessionEnded() {
        this._stores.clearSessionStores();
        this.logger.info("Data storage cleared.");
    }
}
