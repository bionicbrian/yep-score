"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports["default"] = makeValueType;

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function makeValueType(ParentValueType, _ref) {
    var store = _ref.store;
    var fields = _ref.fields;

    function CustomStoreitValue(properties) {
        ParentValueType.call(this, store, properties);
    }

    CustomStoreitValue.prototype = Object.create(ParentValueType.prototype);

    // Expose primary key field as a getter (default is `id`)
    var primaryKey = store.options.primaryKey;

    Object.defineProperty(CustomStoreitValue.prototype, primaryKey, {
        get: function get() {
            return this.key;
        },
        enumerable: true
    });

    fields.forEach(function (field) {
        Object.defineProperty(CustomStoreitValue.prototype, field, {
            get: function get() {
                var val;
                if (this._store.has(this.key)) {
                    var data = this._store.get(this.key);
                    val = data[field];
                }
                return val;
            },
            set: function set(val) {
                this._store.set(this.key, _defineProperty({}, field, val));
            },
            enumerable: true
        });
    });

    return CustomStoreitValue;
}

module.exports = exports["default"];